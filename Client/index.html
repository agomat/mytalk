<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>MyTalk</title>
    <link rel="shortcut icon" href="assets/img/mytalk.ico" />
    <link type="text/css" rel="stylesheet" media="screen" href="assets/font/roboto.css"/>
    <link type="text/css" rel="stylesheet" media="screen" href="assets/css/common.css"/>
    <link type="text/css" rel="stylesheet" media="screen" href="assets/css/c1.css"/>
    <link type="text/css" rel="stylesheet" media="screen" href="assets/css/c2.css"/>
    <link type="text/css" rel="stylesheet" media="screen" href="assets/css/c3.css"/> 
    <link type="text/css" rel="stylesheet" media="screen" href="assets/css/c4.css"/> 
    <link type="text/css" rel="stylesheet" media="screen" href="assets/css/popup.css"/>
    <link type="text/css" rel="stylesheet" media="screen" href="assets/css/call.css"/>
    <link type="text/css" rel="stylesheet" media="screen" href="assets/css/c4-logged.css"/>
    <link type="text/css" rel="stylesheet" media="screen" href="assets/css/profile.css"/>
    <link type="text/css" rel="stylesheet" media="screen" href="assets/css/stats.css"/>
  
    <script type="text/javascript" src="assets/lib/jquery-2.0.2.min.js"></script> 
    <script type="text/javascript" src="assets/lib/moment.min.js"></script>
    <script type="text/javascript" src="assets/lib/handlebars-1.0.0-rc.4.js"></script>
    <script type="text/javascript" src="assets/lib/ember-1.0.0-rc.6.js"></script> 
    <script type="text/javascript" src="assets/lib/ember-data.js"></script>
    <script type="text/javascript" src="assets/lib/list-view.min.js"></script>

    <!-- bootstrap application -->
    <script type="text/javascript" src="com/mytalk/client/MyTalk.js"></script>

    <!-- bootstrap views -->
    
    <script type="text/javascript" src="com/mytalk/client/view/templateview/IndexView.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateview/ListsView.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateview/DashboardView.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateview/LoginFormView.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateview/LoginView.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateview/LoggedView.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateview/RegisterFormView.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateform/RegisterPassword.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateform/IPCall.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateview/UsersView.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateview/GuestView.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateview/ProfileView.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateview/StatsView.js"></script>
    
    <script type="text/javascript" src="com/mytalk/client/view/templateview/LoginView.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateform/RegisterConfirmPassword.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateview/RegisterView.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateform/RegisterSurname.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateview/HeaderView.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateview/MessageFormView.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateview/IPFormView.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateform/LoginUsername.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateform/LoginPassword.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateform/RegisterEmail.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateform/RegisterName.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateform/RegisterUsername.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateform/SearchView.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateform/MessageText.js"></script>

    <script type="text/javascript" src="com/mytalk/client/view/templateform/ModifyConfirmPassword.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateform/ModifySurname.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateform/ModifyEmail.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateform/ModifyName.js"></script>
    <script type="text/javascript" src="com/mytalk/client/view/templateform/ModifyPassword.js"></script>
    
    
    <!-- bootstrap Router -->
    <script type="text/javascript" src="com/mytalk/client/controller/router/Router.js"></script>
    <script type="text/javascript" src="com/mytalk/client/controller/router/IndexRoute.js"></script>
    <script type="text/javascript" src="com/mytalk/client/controller/router/GuestRoute.js"></script>
    <script type="text/javascript" src="com/mytalk/client/controller/router/CallingRoute.js"></script>
    <script type="text/javascript" src="com/mytalk/client/controller/router/LoggedRoute.js"></script>
    <script type="text/javascript" src="com/mytalk/client/controller/router/LoggedIndexRoute.js"></script>
    <script type="text/javascript" src="com/mytalk/client/controller/router/ListRoute.js"></script>
    <script type="text/javascript" src="com/mytalk/client/controller/router/IpcallRoute.js"></script>
    <script type="text/javascript" src="com/mytalk/client/controller/router/ProfileRoute.js"></script>
    <script type="text/javascript" src="com/mytalk/client/controller/router/StatsRoute.js"></script>

    
    <!-- bootstrap StateManager -->
    <script type="text/javascript" src="com/mytalk/client/controller/statemanager/AppState.js"></script>
    <script type="text/javascript" src="com/mytalk/client/controller/statemanager/CallState.js"></script>

    <!-- bootstrap DS.Model -->
    
    <script type="text/javascript" src="com/mytalk/client/model/modelstruct/Authentication.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/modelstruct/PersonalData.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/modelstruct/User.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/modelstruct/List.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/modelstruct/Call.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/modelstruct/WCall.js"></script>

    <!-- bootstrap Requests -->

    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/ProcessorFactory.js"></script>

    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/AbstractInProcessorProduct.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/user/IpAlreadyLoggedLogin.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/user/SuccessfulCreateAccount.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/user/StateUpdate.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/user/UserNotLoggedLogin.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/user/SuccessfulLogin.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/user/SuccessfulUpdateAccount.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/user/AuthenticationFailLogin.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/user/AuthenticationFailUpdateAccount.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/user/UsernameCorrespondingExistingLogin.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/user/SuccessfulLoginAsAnonymous.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/user/SuccessfulDeleteAccount.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/user/AuthenticationFailDeleteAccount.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/user/IpAlreadyLoggedLoginAsAnonymous.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/user/UsernameCorrespondingExistingLogin.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/user/UserAlreadyLoggedLogin.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/user/IpNotLoggedLogin.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/user/UsernameAlreadyExistingCreateAccount.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/communication/CorruptedPack.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/communication/UnsuccessfulAcceptCall.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/communication/UnsuccessfulUserCall.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/communication/SuccessfulUserCall.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/communication/IdNotFoundUserCall.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/communication/SuccessfulRefuseCall.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/communication/SuccessfulAcceptCall.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/stats/AuthenticationFailGetCalls.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/stats/SuccessfulAddCall.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/stats/AuthenticationFailAddCall.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/stats/GiveCalls.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/stats/UsernameNotExistingGetCalls.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/stats/IdNotFoundAddCall.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/UserNotExistingListUserAdd.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/ListAlreadyExists.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/UserNotExistingListUserRemove.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/UserAlreadyBlacklisted.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/SuccessfulBlackListAdd.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/UsernameNotCorrespondingListCreate.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/UserAlreadyListed.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/SuccessfulBlackListRemove.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/SuccessfulListCreate.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/ListNotExistingListDelete.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/IdNotFoundListUserAdd.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/AuthenticationFailBlacklistRemove.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/UsernameNotCorrespondingListUserAdd.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/SuccessfulListUserAdd.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/AuthenticationFailListUserAdd.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/IdNotFoundBlacklistAdd.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/SuccessfulListUserRemove.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/UserNotExistingBlacklistAdd.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/ListAlreadyExistsRenameList.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/AuthenticationFailListCreate.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/AuthenticationFailRenameList.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/ListNotExistingListUserAdd.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/SuccessfulListDelete.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/AuthenticationFailBlacklistAdd.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/ListNotExistingListUserRemove.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/ListNotExistingRenameList.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/UsernameNotCorrespondingListDelete.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/IdNotFoundBlacklistRemove.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/UserNotListed.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/AuthenticationFailListDelete.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/AuthenticationFailListUserRemove.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/SuccessfulRenameList.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/UsernameNotCorrespondingListUserRemove.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/IdNotFoundListUserRemove.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/UserNotCorrespondingBlacklistAdd.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/UserNotBlacklisted.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/incoming/list/UsernameNotCorrespondingRenameList.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/outcoming/AbstractOutProcessorProduct.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/outcoming/user/CreateAccount.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/outcoming/user/Login.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/outcoming/user/DeleteAccount.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/outcoming/user/LogoutToAnonymous.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/outcoming/user/UpdateAccount.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/outcoming/communication/AcceptCall.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/outcoming/communication/UserCall.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/outcoming/communication/RefuseCall.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/outcoming/stats/AddCall.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/outcoming/stats/GetCalls.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/outcoming/list/ListUserAdd.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/outcoming/list/UpdateListName.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/outcoming/list/BlackListRemove.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/outcoming/list/ListCreate.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/outcoming/list/ListUserRemove.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/outcoming/list/BlackListAdd.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/processing/processor/outcoming/list/ListDelete.js"></script>

    <!-- bootstrap Storage -->
    <script type="text/javascript" src="com/mytalk/client/model/storage/ARI.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/storage/WebSocketConnection.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/modelstruct/SocketAdapter.js"></script>
    <script type="text/javascript" src="com/mytalk/client/model/modelstruct/Store.js"></script>

    <!-- bootstrap controllers -->
    <script type="text/javascript" src="com/mytalk/client/controller/controller/IndexController.js"></script>
    <script type="text/javascript" src="com/mytalk/client/controller/controller/GuestController.js"></script>
    <script type="text/javascript" src="com/mytalk/client/controller/controller/LoggedController.js"></script>
    <script type="text/javascript" src="com/mytalk/client/controller/controller/ListController.js"></script>
    <script type="text/javascript" src="com/mytalk/client/controller/controller/UsersController.js"></script>
    <script type="text/javascript" src="com/mytalk/client/controller/controller/ChatMessage.js"></script>
    <script type="text/javascript" src="com/mytalk/client/controller/controller/CallInfo.js"></script>
    <script type="text/javascript" src="com/mytalk/client/controller/controller/CallingController.js"></script>
    <script type="text/javascript" src="com/mytalk/client/controller/controller/IpcallController.js"></script>
    <script type="text/javascript" src="com/mytalk/client/controller/controller/ProfileController.js"></script>
    <script type="text/javascript" src="com/mytalk/client/controller/controller/StatsController.js"></script>
    <script type="text/javascript" src="com/mytalk/client/controller/controller/HistoryController.js"></script>



    <!-- bootstrap RTCAdapter -->
    <script type="text/javascript" src="com/mytalk/client/controller/communicator/PeerConnection.js"></script> 

    <!-- bootstrap jQuery stuffs -->
    <script type="text/javascript" src="assets/animation/animation.js"></script>

  </head>
  <body>
    <script type="text/x-handlebars" data-template-name="index">
      {{ outlet 'head' }}
      {{ outlet 'content' }}
    </script>

    <script type="text/x-handlebars" data-template-name="guest">
      {{ render "ipcall" }}
      {{ partial register }}
    </script>

    <script type="text/x-handlebars" data-template-name="logged">
        <div id="logged_content" class="scroll_content">
          {{ partial lists }} 
        </div>
    </script>

    <script type="text/x-handlebars" data-template-name="_lists">
      <div id="liste">
        <div class="header">
          <h5>Le Tue Liste</h5>
          <a href="#" class="common_button"{{action "createList"}}>Crea una Nuova Lista</a>
          </div>
          <div class="content">
            <ul>

              {{#each list in model}}
                {{#if list.generalList}}
                  <li id="allcontacs">
                   {{#linkTo "list" list}} 
                   <div class="online_user"><div>online</div>{{list.online}}/{{list.total}}</div>
                   <div class="list_name">{{list.name}} </div>{{/linkTo}}
                  </li>
                {{/if}}
              {{/each}}
              
              {{#each list in model}}
                {{#if list.blackList}}
                 <li id="blacklist">
                   {{#linkTo "list" list}} 
                    <div class="online_user"><div>online</div>{{list.online}}/{{list.total}}</div>
                    <div class="list_name">{{list.name}}</div>
                   {{/linkTo}}
                 </li>
                {{/if}} 
              {{/each}}
              
              {{#each list in model}}
                {{#if list.customList}}
                 <li>
                   {{#linkTo "list" list}} 
                   <div class="online_user"><div>online</div>{{list.online}}/{{list.total}}</div>
                   <div class="list_name">{{list.name}}</div>{{/linkTo}}
                 </li>
                {{/if}} 
              {{/each}}

            </ul>
          </div>
      </div>
      <div id="utenti">
        {{ outlet 'list' }}
      </div>
    </script>

    <script type="text/x-handlebars" data-template-name="list">
      <div class="header">
        <h5>{{ name }}<span id="current_online">Online: {{ online }}/{{ total }}</span></h5>
          <div id="list_option">
             {{view MyTalk.SearchView id="search_bar"}}
            <div id="list_button">
            
            {{#if customList}}
                <a href="#" class="common_button" {{action "deleteList" }}>Rimuovi</a> &nbsp;
                <a href="#" class="common_button" {{action "renameList" }}>Rinomina</a>
            {{/if}}
            
            </div>
          </div>
      </div>
      <div class="content">
          {{ render "users" users }}
      </div>
      
    </script>

    <script type="text/x-handlebars" data-template-name="users">  
      <ul id="userlist"> 
        {{#collection Ember.ListView contentBinding="controller.filteredUsers" height=477 rowHeight=60}}
        
         <li>

            <div {{bindAttr class="online:online:offline"}}></div>
            <div class="avatar48">
             <img {{bindAttr src="avatarTiny"}} />
            </div>

            <div class="user_info">
              <div><span>{{ name }} {{ surname }}</span></div>
                {{ username }}
            </div>

            <ul {{bindAttr class="online:callEnebled:callDisabled"}}>
            

            {{#if controller.controllers.list.blackList}}
                <li>
                {{#if online}}
                  <a class="call_user" href="#" {{ action "userCall" this }}> </a>
                {{else}}
                  <a class="call_user" href="#" {{ action "cantCall" this }}> </a>
                {{/if}}

                </li>
                <li><a class="remove_user" href="#" {{action "deleteUser" this }}></a></li>
            {{else}}
                {{#if controller.controllers.list.generalList}}
                  <li>
                  {{#if online}}
                    <a class="call_user" href="#" {{ action "userCall" this }}> </a>
                  {{else}}
                    <a class="call_user" href="#" {{ action "cantCall" this }} > </a>
                  {{/if}}
                  </li>
                  <li><a class="add_user" href="#" {{action "addUser" this }}></a></li>
                  <li><a class="blacklist_user" href="#" {{action "userToBlacklist" this }}></a></li>
                {{else}}
                  <li>
                  {{#if online}}
                    <a class="call_user" href="#" {{ action "userCall" this }}> </a>
                  {{else}}
                    <a class="call_user" href="#" {{ action "cantCall" this }} > </a>
                  {{/if}}
                  </li>
                  <li><a class="add_user" href="#" {{action "addUser" this }}></a></li>
                  <li><a class="remove_user" href="#" {{action "deleteUser" this }}></a></li>
                  <li><a class="blacklist_user" href="#" {{action "userToBlacklist" this }}></a></li>
                {{/if}}
            {{/if}}
            </ul>
          </li>
        
        {{/collection}}

      </ul>

      
       <div id="adduser" class="blanket">
       {{controller.loadSelect}}
        <div class="modal">
          <div class="modal_header">
            <a href="#" {{action "closeSelect"}}></a>
            <h3>Aggungi ad una lista</h3>
          </div>
          <form action="#">
            <fieldset>
              <legend hidden>Aggungi ad una lista</legend>
              <div class="modal_content">
                <p> Segli a quale lista aggiungere l`utente {{ controller.userName }}</p>
                <label for="search_list" hidden>Scegli la lista</label>
                  {{view Ember.Select 
                    contentBinding="controller.controllers.logged.filteredList"
                    optionValuePath="content.id"
                    optionLabelPath="content.name"
                    prompt="Seleziona un lista"
                    valueBinding="controller.selectedValue"
                  }}
              </div>
              <div class="modal_button">
                <button type="button" class="common_button" {{action "doAddUser"}}>Ok</button>
                <button type="button" id="hangup_button" {{action "closeSelect"}}>Annulla</button>
              </div>
            </fieldset>
          </form>
        </div>
      </div>
    </script>

    <script type="text/x-handlebars" data-template-name="header">
      <div id="header">
        <div id="logo">
          <h1>MyTalk</h1>
        </div>
        {{ partial "dashboard" }}
      </div>
    </script>

    <script type="text/x-handlebars" data-template-name="_dashboard">
      {{#if isAuthenticated}}
        <div id="menu_container">
        {{#each me in model}}
        {{#if me.name}}
          <div id="menu_label" >
            <div class="avatar"> 
              <img {{bindAttr src="me.avatarTiny"}} alt="" />
            </div>
          <div id="identity" class="logged">{{ me.name }} {{ me.surname }}</div>
          </div>
          <div id="menu_area">
            <div id="arrow"></div>
            <div id="menu_content">
              <div id="auth_content">
                <h2>Sei collegato come:</h2>
                <ul>
                  <li>{{ me.name }} {{ me.surname }}</li>
                  <li>{{ me.email }}</li>
                </ul>
                <ul class="separator">
                  <li><img src="assets/img/settings.png" alt="" /> {{#linkTo 'profile'}}Modifica Profilo {{/linkTo}}</li>
                  <li><img src="assets/img/stats.png" alt="" /> {{#linkTo 'stats'}} Statistiche delle chiamate {{/linkTo}}</li>
                </ul>
                <ul class="separator">
                  <li><img src="assets/img/allcontacts.png" alt="" /> {{#linkTo 'ipcall'}} Chiama un IP globale {{/linkTo}}</li>
                  <li><img src="assets/img/users.png" alt="" /> {{#linkTo 'list'}} Visualizza i miei contatti {{/linkTo}}</li>
                </ul>
                <ul class="separator">
                  <li><img src="assets/img/door_out.png" alt=""/> <a href=".">Esci</a></li>
                </ul>
              </div>
            </div>
          </div> 
        </div>
        {{/if}}
        {{/each}}
      {{else}}
        <div id="menu_container">
          <div id="menu_label">
            <div id="identity">Accedi</div>
            <img src="assets/img/open_door.png"/>
          </div>
          <div id="menu_area" >
            <div id="arrow"></div>
            <div id="menu_content">
              {{#view MyTalk.LoginFormView }}   
                <fieldset>
                  <legend hidden>Loggati</legend>
                  <ul>
                    <li>
                      <label for="email" hidden>Email</label>
                      {{view MyTalk.LoginUsername valueBinding='view.username'}}
                    </li>
                    <li>
                      <label for="password" hidden>Password</label>
                      {{view MyTalk.LoginPassword valueBinding='view.password' }}
                    </li>
                  </ul>
                  <button type="submit" id="button_login" class="common_button">Accedi</button>
                  <p id="loading_bar" >Caricamento contatti in corso... </p>
                  
                 
                 
                </fieldset>
                {{/view}}
            </div>
          </div> 
        </div>
      {{/if}}
    </script>

    <script type="text/x-handlebars" data-template-name="_register">
      <div id="notlogged_content">
        <div id="video_container">
          <div id="video_frame">
            <h5>Video Tutorial</h5>
            <p>In <em>due minuti</em>, scopri quanto è semplice utilizzare MyTalk.</p>
            <video id="video_tutorial" poster="assets/img/video_placeholder.png">
              <source src="assets/video/intro.ogg" type="video/ogg" />
              <source src="assets/video/intro.mp4" type="video/mp4" />
              Il tuo browser non supporta il video in html5
            </video>
          </div>
        </div>
        <div id="divider"></div>
        <div id="signup_container">
          <div id="signup">
            <h5>Registrati ora!</h5>
            <p>Registrarsi &egrave; gratuito e ti permette di chiamare gli altri utenti che gi&agrave; utilizzano MyTalk.</p>
            {{#view MyTalk.RegisterFormView}}
              <fieldset>
                <legend hidden>Registrazione</legend>
                <ul>
                  <li>
                    <label for="name" hidden>Nome</label>
                    {{view MyTalk.RegisterName valueBinding='view.name' }}
                  </li>
                  <li>
                    <label for="surname" hidden>Cognome</label>
                    {{view MyTalk.RegisterSurname valueBinding='view.surname' }}
                  </li>
                  <li>
                    <label for="username" hidden>Username</label>
                    {{view MyTalk.RegisterUsername valueBinding='view.username' }}
                  </li>
                  <li>
                    <label for="email" hidden>Email</label>
                    {{view MyTalk.RegisterEmail valueBinding='view.email' }}
                  </li>
                  <li>
                    <label for="password" hidden>Password</label>
                    {{view MyTalk.RegisterPassword valueBinding='view.password' }}
                  </li>
                  <li>
                    <label for="password_conf" hidden>Conferma la password</label>
                    {{view MyTalk.RegisterConfirmPassword valueBinding='view.password_conf' }}
                  </li>
                  <li>
                    <button type="submit"class="common_button" id="button_signup">Registrati</button>
                  </li>
                </ul>
              </fieldset>
            {{/view}}
          </div>
        </div>
      </div>
    </script>

    <script type="text/x-handlebars" data-template-name="ipcall">
      <div id="ip_container">
        <div id="ip_call">
          <h3> Chiama i tuoi amici </h3>
          <p>
            Inserisci l`indirizzo IP di un amico e mettiti in contatto con lui!
          </p>
          {{#view MyTalk.IPFormView}}
            <fieldset>
              <legend hidden>Chiama inserendo l`indirizzo IP</legend>
              <label for="ip_call_text" hidden>Indirizzo IP</label> 
              {{view MyTalk.IPCall valueBinding='view.ip_call'}}
                <button id="ip_call_button" class="common_button" type="submit"><div></div>Chiama</button>
            </fieldset>
          {{/view}}
        </div>
        <div id="ip_yours">
          <h3>Il tuo indirizzo IP</h3>
          <p>
            Fornisci ai tuoi amici questo indirizzo IP. Sarai repereribile da qualsiasi utente che conosca il tuo IP senza doversi registrare nel sistema!
          </p>
          <h4 id="ip_address"> {{ controller.myIP }} {{ controller.content.ip }} </h4>
        </div>
      </div>
    </script>

    <script type="text/x-handlebars" data-template-name="calling">
     <div id="call_content" class="scroll_content">
     
      <div id="chat" {{bindAttr class="isConnected:visible:hidden"}}>
        <ul id="messages">
          {{#each message in controller.messages}}
          <li {{bindAttr class="message.sent:sent_message:received_message"}} >
          {{ message.text }}<div class="date"> {{ date message.date }}</div></li>
          {{/each}}

        </ul>
        {{#view MyTalk.MessageFormView }}
          <fieldset>
            <legend hidden>Scrivi un messaggio</legend>
            <label for="text_input" hidden>Scrivi un messaggio</label> 
            {{view MyTalk.MessageText attributeBinding='id' valueBinding='view.message'}}
            <button class="common_button" id="submitMessage">Invia</button>
          </fieldset>
        {{/view}}
      </div>

      <div id="comunicazione">

        <video id="local" autoplay muted {{bindAttr class="isConnected:dispay_yes:display_none"}}></video>
        <video id="remote" autoplay {{bindAttr class="isConnected:dispay_yes:display_none"}}></video>
        
        {{#unless isConnected}}
          <div class="call_placeholder">
            <div class="avatar300">
             <img {{bindAttr src="avatarBig"}} />
             {{#if isIncomingCall}}
               <h2><em>{{fullName}}</em> ti sta chiamando</h2>
             {{else}}
               <h2>Contattando <em>{{fullName}}</em></h2>
             {{/if}}
            </div>
          </div>
        {{/unless}}

        <button {{action "acceptCall" this}} {{bindAttr class="isIncomingCall:display_yes:display_none"}} id="answer_button" ><div></div> Rispondi</button>&nbsp;
        <button {{action "closeCall" this}} id="hangup_button" ><div></div>Riaggancia</button>

        <ul id="statistiche" {{bindAttr class="isConnected:display_yes:display_none"}}> 
          <li><span>Tempo trascorso:</span>{{hourconversion stats.duration}}</li>
          <li><span>Byte ricevuti:</span>{{conversion stats.receivedBytes}}</li>
          <li><span>Byte trasmessi:</span>{{conversion stats.sentBytes}}</li>
          <li><span>Velocit&agrave;:</span>{{bitrate}}<span id="bitrate"></span></li>
        </ul>
        <div id="stats"></div>

      </div>
    </div>
    <audio id="ring" src="assets/sounds/ring.mp3" preload></audio>
    <audio id="modem-dial" src="assets/sounds/modem-dial.mp3" preload></audio>
    <audio id="closeCall" src="assets/sounds/close.mp3" preload></audio>
    <audio id="busy" src="assets/sounds/busy.mp3" preload></audio>
    </script>
    
    <script type="text/x-handlebars" data-template-name="profile">
        <div id="modifica_text">
        <h2>Modifica Profilo</h2>
        <p>Modifica i tuoi dati personali cambiando nome, cognome o email. La modifica della password richiede la conferma.</p>
        <p>Puoi eliminare il tuo account tramite l`apposito bottone; <em>MyTalk</em> non mantiene i tuoi dati una volta cancellato l`account. </p>
        <p>L`operazione una volta effettuata non è reversibile.</p>
        <h2>Modifica la tua foto</h2>
        <p>Per modificare la tua foto registrati o accedi al servizio esterno Gravatar (<span>it.gravatar.com</span>).</p>
        <p>Puoi caricare una foto dal tuo computer oppure fornire un indirizzo URL dell`immagine che desideri utilizzare. </p>
        <p>La tua foto sarà visibile a tutti gli utenti che utilizzano <em>MyTalk</em>.</p>
        </div>
      <div id="me">
        {{#view MyTalk.ProfileView}}
            <fieldset>
              <legend hidden>Modifica Profilo</legend>
              <ul id="newdata">
                <li>
                  <label for="name">Nome</label>
                  <span>{{view MyTalk.ModifyName valueBinding='view.name'}}</span>
                </li>
                <li>
                  <label for="surname" >Cognome</label>
                  <span>{{view MyTalk.ModifySurname valueBinding='view.surname' }}</span>
                </li>
                <li>
                  <label for="email" >Indirizzo email</label>
                  <span>{{view MyTalk.ModifyEmail valueBinding='view.email' }}</span>
                </li>
                <li>
                  <label for="password" >Nuova password</label>
                  <span>{{view MyTalk.ModifyPassword valueBinding='view.password' }}</span>
                </li>
                <li>
                  <label for="password_conf" >Conferma la password</label>
                  <span>{{view MyTalk.ModifyConfirmPassword valueBinding='view.password_conf' }}</span>
                </li>
                <li>
                  <button type="submit"class="common_button" id="button_signup">Aggiorna Dati</button>
                </li>
              </ul>
            </fieldset>
             <div id="elimina_block">
                <label for="button_elimina"> Elimina il tuo account:</label>
                <button type="button" class="common_button" id="button_elimina" {{action "deleteAccount"}}>Elimina</button>
            </div>
          {{/view}}
            
      </div>
    </script>
    
    <script type="text/x-handlebars" data-template-name="stats">
      <div id="stats">
        <div id="global_stats">
          <h2>Statistiche Globali</h2>
          <img src="assets/img/stats_big.png" alt="" />
          <ul>
         
            <li id="global_time"><strong>Tempo totale in chiamata: </strong>{{hourconversion content.totalDuration}}</li>
            <li id="global_inbyte"><strong>Totale dati ricevuti: </strong>{{conversion content.totalByteSent}}</li>
            <li id="global_outbyte"><strong>Totale dati inviati: </strong>{{conversion content.totalByteReceived}}</li>
          
          </ul>
        </div>
        {{render history}}
      </div>
    </script>

    <script type="text/x-handlebars" data-template-name="history">
      <h3>Registro Chiamate</h3>
      <ul id="call_list">
      {{#each call in controller}}
        <li {{bindAttr class="call.caller:call_in:call_out"}}> 
          <div class="avatar35"><img {{bindAttr src="call.speaker.avatarSuperTiny"}} /> </div>
          <div class="who_call">{{call.speaker.name}} {{call.speaker.surname}}</div>
          <div class="data_call"> {{calldate call.startDate}}</div>
          <div class="duration_call">{{hourconversion call.duration}}</div>
        </li>
      {{/each}}
      </ul>
    </script>

  </body>
</html>
